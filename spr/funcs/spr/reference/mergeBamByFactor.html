<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merge BAM files based on factor — mergeBamByFactor • systemPipeR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Merge BAM files based on factor — mergeBamByFactor" />
<meta property="og:description" content="Merges BAM files based on sample groupings provided by a factor using internally
the mergeBam function from the Rsamtools package. The function also returns
an updated SYSargs or SYSargs2 object containing the paths to the merged BAM files as well as 
to the unmerged BAM files if there are any. All rows of merged parent samples are removed.
The functionality provided by mergeBamByFactor is useful for experiments where 
pooling of replicates is advantageous to maximize the depth of read coverage, such as prior to 
peak calling in ChIP-Seq or miRNA gene prediction experiments." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CCMXLYXWYV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CCMXLYXWYV');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">systemPipeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.27.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://systempipe.org/spr/">
    <span class="fa fa-home"></span>
     
    SPR Home
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merge BAM files based on factor</h1>
    
    <div class="hidden name"><code>mergeBamByFactor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Merges BAM files based on sample groupings provided by a factor using internally
the <code>mergeBam</code> function from the <code>Rsamtools</code> package. The function also returns
an updated <code>SYSargs</code> or <code>SYSargs2</code> object containing the paths to the merged BAM files as well as 
to the unmerged BAM files if there are any. All rows of merged parent samples are removed.</p>
<p>The functionality provided by <code>mergeBamByFactor</code> is useful for experiments where 
pooling of replicates is advantageous to maximize the depth of read coverage, such as prior to 
peak calling in ChIP-Seq or miRNA gene prediction experiments.</p>
    </div>

    <pre class="usage"><span class='fu'>mergeBamByFactor</span><span class='op'>(</span><span class='va'>args</span>, mergefactor <span class='op'>=</span> <span class='st'>"Factor"</span>, overwrite <span class='op'>=</span> <span class='cn'>FALSE</span>, silent <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>args</th>
      <td><p>An instance of <code>SYSargs</code> or <code>SYSargs2</code> constructed from a <code>targets</code> file where the first 
column (<code><a href='sysargs.html'>targetsin(args)</a></code> or <code><a href='targets.as.df.html'>targets.as.df(targets(args))</a></code>) contains the paths 
to the BAM files along with the column title <code>FileName</code>.</p></td>
    </tr>
    <tr>
      <th>mergefactor</th>
      <td><p><code>factor</code> containing the grouping information required for merging the BAM files 
referenced in the first column of <code><a href='sysargs.html'>targetsin(args)</a></code> or <code><a href='targets.as.df.html'>targets.as.df(targets(args))</a></code>.
The default uses <code>Factor</code> column from the <code>targets</code> files as factor. 
The latter merges BAM files for which replicates are specified in the <code>Factor</code> column.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>If <code>overwrite=FALSE</code> existing BAM files of the same name will not be overwritten.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>If <code>silent=TRUE</code> print statements will be suppressed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>To pass on additional arguments to the internally used <code>mergeBam</code> function from <code>Rsamtools</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The merged BAM files will be written to output files with the following naming
convention: &lt;first_BAM_file_name&gt;_&lt;grouping_label_of_factor&gt;.&lt;bam&gt;. In
addition, the function returns an updated <code>SYSargs</code> or <code>SYSargs2</code> object where all
output file paths contain the paths to the merged BAM files. The rows of the
merged parent samples are removed and the rows of the unmerged samples remain unchanged.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Thomas Girke</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>writeTargetsout</code>, <code>writeTargetsRef</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Construct initial SYSargs object</span>
<span class='va'>targetspath</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"targets_chip.txt"</span>, package<span class='op'>=</span><span class='st'>"systemPipeR"</span><span class='op'>)</span>
<span class='va'>parampath</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"bowtieSE.param"</span>, package<span class='op'>=</span><span class='st'>"systemPipeR"</span><span class='op'>)</span>
<span class='va'>args</span> <span class='op'>&lt;-</span> <span class='fu'><a href='systemArgs.html'>systemArgs</a></span><span class='op'>(</span>sysma<span class='op'>=</span><span class='va'>parampath</span>, mytargets<span class='op'>=</span><span class='va'>targetspath</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: path[1]="./data/SRR446027_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[2]="./data/SRR446028_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[3]="./data/SRR446029_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[4]="./data/SRR446030_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[5]="./data/SRR446031_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[6]="./data/SRR446032_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[7]="./data/SRR446033_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[8]="./data/SRR446034_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[9]="./data/SRR446035_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[10]="./data/SRR446036_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[11]="./data/SRR446037_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[12]="./data/SRR446038_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[13]="./data/SRR446039_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[14]="./data/SRR446040_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[15]="./data/SRR446041_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[16]="./data/SRR446042_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[17]="./data/SRR446043_1.fastq.gz": No such file or directory</span></div><div class='output co'>#&gt; <span class='warning'>Warning: path[18]="./data/SRR446044_1.fastq.gz": No such file or directory</span></div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## After running alignmets (e.g. with Bowtie2) generate targets file </span>
<span class='co'>## for the corresponding BAM files. The alignment step is skipped here.</span>
<span class='fu'><a href='writeTargetsout.html'>writeTargetsout</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>args</span>, file<span class='op'>=</span><span class='st'>"targets_bam.txt"</span>, overwrite<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> 
<span class='va'>args</span> <span class='op'>&lt;-</span> <span class='fu'><a href='systemArgs.html'>systemArgs</a></span><span class='op'>(</span>sysma<span class='op'>=</span><span class='cn'>NULL</span>, mytargets<span class='op'>=</span><span class='st'>"targets_bam.txt"</span><span class='op'>)</span>

<span class='co'>## Merge BAM files and return updated SYSargs object</span>
<span class='va'>args_merge</span> <span class='op'>&lt;-</span> <span class='fu'>mergeBamByFactor</span><span class='op'>(</span><span class='va'>args</span>, overwrite<span class='op'>=</span><span class='cn'>TRUE</span>, silent<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>## Export modified targets file </span>
<span class='fu'><a href='writeTargetsout.html'>writeTargetsout</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>args_merge</span>, file<span class='op'>=</span><span class='st'>"targets_mergeBamByFactor.txt"</span>, overwrite<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> 
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://girke.bioinformatics.ucr.edu/'>Thomas Girke</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


