<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Genome read coverage by transcript models — featureCoverage • systemPipeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Genome read coverage by transcript models — featureCoverage"><meta property="og:description" content="Computes read coverage along single and multi component features based on
genomic alignments. The coverage segments of component features are spliced to
continuous ranges, such as exons to transcripts or CDSs to ORFs.  The results
can be obtained with single nucleotide resolution (e.g. around start and stop
codons) or as mean coverage of relative bin sizes, such as 100 bins for each
feature. The latter allows comparisons of coverage trends among transcripts of
variable length. The results can be obtained for single or many features (e.g.
any number of transcritpts) at once.  Visualization of the coverage results is
facilitated by a downstream plotfeatureCoverage function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-CCMXLYXWYV"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CCMXLYXWYV');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">systemPipeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tgirke/systemPipeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Genome read coverage by transcript models</h1>
    
    <div class="hidden name"><code>featureCoverage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes read coverage along single and multi component features based on
genomic alignments. The coverage segments of component features are spliced to
continuous ranges, such as exons to transcripts or CDSs to ORFs.  The results
can be obtained with single nucleotide resolution (e.g. around start and stop
codons) or as mean coverage of relative bin sizes, such as 100 bins for each
feature. The latter allows comparisons of coverage trends among transcripts of
variable length. The results can be obtained for single or many features (e.g.
any number of transcritpts) at once.  Visualization of the coverage results is
facilitated by a downstream <code>plotfeatureCoverage</code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">featureCoverage</span><span class="op">(</span><span class="va">bfl</span>, <span class="va">grl</span>, resizereads <span class="op">=</span> <span class="cn">NULL</span>, readlengthrange <span class="op">=</span> <span class="cn">NULL</span>, Nbins <span class="op">=</span> <span class="fl">20</span>, 
                method <span class="op">=</span> <span class="va">mean</span>, <span class="va">fixedmatrix</span>, <span class="va">resizefeatures</span>, <span class="va">upstream</span>, <span class="va">downstream</span>, 
                <span class="va">outfile</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bfl</dt>
<dd><p>Paths to BAM files provided as <code>BamFileList</code> object. The name slot of the
BAM files will be used for naming samples in the results.</p></dd>
<dt>grl</dt>
<dd><p>Genomic ranges provided as <code>GRangesList</code> typically generated form
<code>txdb</code> instances with operations like: <code>cdsBy(txdb, "tx")</code> or
<code>exonsBy(txdb, "tx")</code>. Single component features will be processed the
same way as multi component features.</p></dd>
<dt>resizereads</dt>
<dd><p>Positive integer defining the length alignments should be resized to prior to the 
coverage calculation. <code>NULL</code> will omit the resizing step.</p></dd>
<dt>readlengthrange</dt>
<dd><p>Positive integer of length 2 determining the read length range to use for
the coverage calculation. Reads falling outside of the specified length range
will be excluded from the coverage calculation. For instance,
<code>readlengthrange=c(30:40)</code> will base the coverage calculation on reads
between 30 to 40 bps. Assigning <code>NULL</code> will skip this filtering step.</p></dd>
<dt>Nbins</dt>
<dd><p>Single positive integer defining the number of segments the coverage of each
feature should be binned into in order to obtain coverage summaries of constant
length, e.g. for plotting purposes.</p></dd>
<dt>method</dt>
<dd><p>Defines the summary statistics to use for binning. The default is <code>method=mean</code>.</p></dd>
<dt>fixedmatrix</dt>
<dd><p>If set to <code>TRUE</code>, a coverage matrix with single nucleotide resolution will be
returned for any number of transcripts centered around precise anchor points in
a genome annotation, such a stop/start codons or transcription start sites. For instance, a 
matrix with coverage information 20bps upstream and downstream of the stop/start codons can be 
obtained with <code>fixedmatrix=TRUE, upstream=20, downstream=20</code> along with a <code>grl</code> 
instance containing the CDS exon ranges required for this operation, e.g. generated 
with <code>cdsBy(txdb, "tx")</code>.</p></dd>
<dt>resizefeatures</dt>
<dd><p>Needs to be set to <code>TRUE</code> when <code>fixedmatrix=TRUE</code>. Internally, this will use
the <code>systemPipeR::.resizeFeature</code> function to extend single and multi component
features at their most left and most right end coordinates. The corresponding extension 
values are specified under the <code>upstream</code> and <code>downstream</code> arguments.</p></dd>
<dt>upstream</dt>
<dd><p>Single positive integer specifying the upstream extension length relative to the orientation
of each feature in the genome. More details are given above.</p></dd>
<dt>downstream</dt>
<dd><p>Single positive integer specifying the downstream extension length relative to the orientation
of each feature in the genome. More details are given above.</p></dd>
<dt>outfile</dt>
<dd><p>Default <code>NULL</code> omits writing of the results to a file. If a file name is specified then
the results are written to a tabular file. If <code>bfl</code> contains the paths to several BAM files
then the results will be appended to the same file where the first column specifies the
sample labels. Redirecting the results to file is particularly useful when processing large 
files of many sample where computation times can be significant.</p></dd>
<dt>overwrite</dt>
<dd><p>If set to <code>TRUE</code> any existing file assigned to <code>outfile</code> will be overwritten.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function allows to return the following four distinct outputs. The settings to return
these instances are illustrated below in the example section.</p>
<dl><dt>(A)</dt>
<dd><p><code>data.frame</code> containing binned coverage where rows are features and columns 
coverage bins. The first four columns contain (i) the sample names, (ii) the number of 
total aligned reads in the corresponding BAM files (useful for normalization), (iii) the
feature IDs, (iv) strand of the coverage. All following columns are numeric and contain
the actual coverage data for the sense and antisense strand of each feature.</p></dd>
<dt>(B)</dt>
<dd><p><code>data.frame</code> containing coverage with single nucleotide
resolution around anchor points such as start and stop codons. The two matrix
components are appended column-wise. To clearly distinguish the two data components, 
they are separated by a specialty column containing pipe characters. The first four 
columns are the same as described under (A). The column title for the
anchor point is 0. For instance, if the features are CDSs then the first 0 corresponds to the
first nucleotide of the start codon and the second 0 to the last nucleotide of
the stop codon. Upstream and downstream positions are indicated by negative and
positive column numbers, respectively.</p></dd>
<dt>(C)</dt>
<dd><p><code>data.frame</code> containing combined results of (A) and (B) where the
first set of columns contains to the coverage around the start codons, the second one
the binned coverage of the CDSs and the third one the coverage around the stop codons 
separated by the same pipe columns mentioned under (B).</p></dd>
<dt>(D)</dt>
<dd><p><code>Rle</code> list containing the nucleotide level coverage of each feature</p></dd>
</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Girke</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>plotfeatureCoverage</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Construct SYSargs2 object from param and targets files </span></span>
<span class="r-in"><span class="va">targetspath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"targets.txt"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dir_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cwl"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">loadWorkflow</a></span><span class="op">(</span>targets<span class="op">=</span><span class="va">targetspath</span>, wf_file<span class="op">=</span><span class="st">"hisat2/hisat2-mapping-se.cwl"</span>, </span>
<span class="r-in">                  input_file<span class="op">=</span><span class="st">"hisat2/hisat2-mapping-se.yml"</span>, dir_path<span class="op">=</span><span class="va">dir_path</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">renderWF</a></span><span class="op">(</span><span class="va">args</span>, inputvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>FileName<span class="op">=</span><span class="st">"_FASTQ_PATH1_"</span>, SampleName<span class="op">=</span><span class="st">"_SampleName_"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00; font-weight: bold;">Instance of 'SYSargs2':</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Slot names/accessors: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       targets: 18 (M1A...V12B), targetsheader: 4 (lines)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       modules: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       wf: 0, clt: 1, yamlinput: 7 (inputs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       input: 18, output: 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       cmdlist: 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sub Steps:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1. hisat2-mapping-se (rendered: TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## Features from sample data of systemPipeRdata package</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicFeatures" class="external-link">GenomicFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/annotation"</span>, <span class="st">"tair10.gff"</span>, package<span class="op">=</span><span class="st">"systemPipeRdata"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/makeTxDbFromGFF.html" class="external-link">makeTxDbFromGFF</a></span><span class="op">(</span>file<span class="op">=</span><span class="va">file</span>, format<span class="op">=</span><span class="st">"gff3"</span>, organism<span class="op">=</span><span class="st">"Arabidopsis"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">targetspath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"targets.txt"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dir_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cwl"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">loadWorkflow</a></span><span class="op">(</span>targets<span class="op">=</span><span class="va">targetspath</span>, wf_file<span class="op">=</span><span class="st">"hisat2/hisat2-mapping-se.cwl"</span>, </span>
<span class="r-in">                  input_file<span class="op">=</span><span class="st">"hisat2/hisat2-mapping-se.yml"</span>, dir_path<span class="op">=</span><span class="va">dir_path</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">renderWF</a></span><span class="op">(</span><span class="va">args</span>, inputvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span>FileName<span class="op">=</span><span class="st">"_FASTQ_PATH1_"</span>, SampleName<span class="op">=</span><span class="st">"_SampleName_"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="runCommandline.html">runCommandline</a></span><span class="op">(</span><span class="va">args</span>, make_bam <span class="op">=</span> <span class="cn">TRUE</span>, dir <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">outpaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetWF.html">subsetWF</a></span><span class="op">(</span><span class="va">args</span> , slot<span class="op">=</span><span class="st">"output"</span>, subset<span class="op">=</span><span class="fl">1</span>, index<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">outpaths</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (A) Generate binned coverage for two BAM files and 4 transcripts</span></span>
<span class="r-in"><span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcriptsBy.html" class="external-link">cdsBy</a></span><span class="op">(</span><span class="va">txdb</span>, <span class="st">"tx"</span>, use.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fcov</span> <span class="op">&lt;-</span> <span class="fu">featureCoverage</span><span class="op">(</span>bfl<span class="op">=</span><span class="fu">BamFileList</span><span class="op">(</span><span class="va">outpaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, grl<span class="op">=</span><span class="va">grl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, resizereads<span class="op">=</span><span class="cn">NULL</span>, </span>
<span class="r-in">                    readlengthrange<span class="op">=</span><span class="cn">NULL</span>, Nbins<span class="op">=</span><span class="fl">20</span>, method<span class="op">=</span><span class="va">mean</span>, fixedmatrix<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span class="r-in">                    resizefeatures<span class="op">=</span><span class="cn">TRUE</span>, upstream<span class="op">=</span><span class="fl">20</span>, downstream<span class="op">=</span><span class="fl">20</span>,</span>
<span class="r-in">                    outfile<span class="op">=</span><span class="st">"results/featureCoverage.xls"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotfeatureCoverage.html">plotfeatureCoverage</a></span><span class="op">(</span>covMA<span class="op">=</span><span class="va">fcov</span>, method<span class="op">=</span><span class="va">mean</span>, scales<span class="op">=</span><span class="st">"fixed"</span>, scale_count_val<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (B) Coverage matrix upstream and downstream of start/stop codons</span></span>
<span class="r-in"><span class="va">fcov</span> <span class="op">&lt;-</span> <span class="fu">featureCoverage</span><span class="op">(</span>bfl<span class="op">=</span><span class="fu">BamFileList</span><span class="op">(</span><span class="va">outpaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, grl<span class="op">=</span><span class="va">grl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, resizereads<span class="op">=</span><span class="cn">NULL</span>, </span>
<span class="r-in">                    readlengthrange<span class="op">=</span><span class="cn">NULL</span>, Nbins<span class="op">=</span><span class="cn">NULL</span>, method<span class="op">=</span><span class="va">mean</span>, fixedmatrix<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span class="r-in">                    resizefeatures<span class="op">=</span><span class="cn">TRUE</span>, upstream<span class="op">=</span><span class="fl">20</span>, downstream<span class="op">=</span><span class="fl">20</span>, </span>
<span class="r-in">                    outfile<span class="op">=</span><span class="st">"results/featureCoverage_up_down.xls"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotfeatureCoverage.html">plotfeatureCoverage</a></span><span class="op">(</span>covMA<span class="op">=</span><span class="va">fcov</span>, method<span class="op">=</span><span class="va">mean</span>, scales<span class="op">=</span><span class="st">"fixed"</span>, scale_count_val<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (C) Combined matrix for both binned and start/stop codon </span></span>
<span class="r-in"><span class="va">fcov</span> <span class="op">&lt;-</span> <span class="fu">featureCoverage</span><span class="op">(</span>bfl<span class="op">=</span><span class="fu">BamFileList</span><span class="op">(</span><span class="va">outpaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, grl<span class="op">=</span><span class="va">grl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, resizereads<span class="op">=</span><span class="cn">NULL</span>, </span>
<span class="r-in">                    readlengthrange<span class="op">=</span><span class="cn">NULL</span>, Nbins<span class="op">=</span><span class="fl">20</span>, method<span class="op">=</span><span class="va">mean</span>, fixedmatrix<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span class="r-in">                    resizefeatures<span class="op">=</span><span class="cn">TRUE</span>, upstream<span class="op">=</span><span class="fl">20</span>, downstream<span class="op">=</span><span class="fl">20</span>, </span>
<span class="r-in">                    outfile<span class="op">=</span><span class="st">"results/featureCoverage_binned.xls"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotfeatureCoverage.html">plotfeatureCoverage</a></span><span class="op">(</span>covMA<span class="op">=</span><span class="va">fcov</span>, method<span class="op">=</span><span class="va">mean</span>, scales<span class="op">=</span><span class="st">"fixed"</span>, scale_count_val<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (D) Rle coverage objects one for each query feature</span></span>
<span class="r-in"><span class="va">fcov</span> <span class="op">&lt;-</span> <span class="fu">featureCoverage</span><span class="op">(</span>bfl<span class="op">=</span><span class="fu">BamFileList</span><span class="op">(</span><span class="va">outpaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, grl<span class="op">=</span><span class="va">grl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, resizereads<span class="op">=</span><span class="cn">NULL</span>, </span>
<span class="r-in">                    readlengthrange<span class="op">=</span><span class="cn">NULL</span>, Nbins<span class="op">=</span><span class="cn">NULL</span>, method<span class="op">=</span><span class="va">mean</span>, fixedmatrix<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span class="r-in">                    resizefeatures<span class="op">=</span><span class="cn">TRUE</span>, upstream<span class="op">=</span><span class="fl">20</span>, downstream<span class="op">=</span><span class="fl">20</span>, </span>
<span class="r-in">                    outfile<span class="op">=</span><span class="st">"results/featureCoverage_query.xls"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://girke.bioinformatics.ucr.edu/" class="external-link">Thomas Girke</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

