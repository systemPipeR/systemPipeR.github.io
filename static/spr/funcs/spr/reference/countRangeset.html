<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read counting for several range sets — countRangeset • systemPipeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read counting for several range sets — countRangeset"><meta property="og:description" content="Convenience function to perform read counting iteratively for serveral 
range sets, e.g. peak range sets or feature types. Internally, 
the read counting is performed with the summarizeOverlaps
function from the GenomicAlignments package. The resulting count 
tables are directly saved to files."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-CCMXLYXWYV"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CCMXLYXWYV');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">systemPipeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.30</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tgirke/systemPipeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read counting for several range sets</h1>
    
    <div class="hidden name"><code>countRangeset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convenience function to perform read counting iteratively for serveral 
range sets, e.g. peak range sets or feature types. Internally, 
the read counting is performed with the <code>summarizeOverlaps</code>
function from the <code>GenomicAlignments</code> package. The resulting count 
tables are directly saved to files.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">countRangeset</span><span class="op">(</span><span class="va">bfl</span>, <span class="va">args</span>, outfiles<span class="op">=</span><span class="cn">NULL</span>, format<span class="op">=</span><span class="st">"tabular"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bfl</dt>
<dd><p><code>BamFileList</code> object containing paths to one or more BAM files.</p></dd>
<dt>args</dt>
<dd><p>An instance of <code>SYSargs</code> or <code>SYSargs2</code> constructed from a
    <code>targets</code> file where the first column (<code>targetsin(args)</code> or 
    <code>targets.as.df(targets(args))</code>) contains the paths to the tabular range 
    data files (e.g. peak ranges) used for counting. Another possibily is 
    <code>named character vector</code> with the paths to the tabular range data files 
    and the elements names should be the sampleID.</p></dd>
<dt>outfiles</dt>
<dd><p>Default is <code>NULL</code>. When <code>args</code> is an object of <code>named 
    character vector</code> class, <code>outfile</code> argument is required. 
    <code>Named character vector</code> with the paths to the resulting count tables
    and the elements names should be the sampleID.</p></dd>
<dt>format</dt>
<dd><p>Format of input range files. Currently, supported are <code>tabular</code> or 
    <code>bed</code>. If <code>tabular</code> is selected then the input range files need 
    to contain the proper column titles to coerce with <code>as(..., "GRanges")</code> 
    to <code>GRanges</code>  objects after importing them with <code>read.delim</code>. The 
    latter is the case for the peak files (<code>*peaks.xls</code>) generated by the 
    MACS2 software.</p></dd>
<dt>...</dt>
<dd><p>Arguments to be passed on to internally used <code>summarizeOverlaps</code>
    function.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Named character vector containing the paths from <code>outpaths(args)</code> to the 
resulting count table files.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Girke</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>summarizeOverlaps</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Paths to BAM files</span></span>
<span class="r-in"><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"bowtieSE.param"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"targets.txt"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args_bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="systemArgs.html">systemArgs</a></span><span class="op">(</span>sysma<span class="op">=</span><span class="va">param</span>, mytargets<span class="op">=</span><span class="va">targets</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[1]="./data/SRR446027_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[2]="./data/SRR446028_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[3]="./data/SRR446029_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[4]="./data/SRR446030_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[5]="./data/SRR446031_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[6]="./data/SRR446032_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[7]="./data/SRR446033_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[8]="./data/SRR446034_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[9]="./data/SRR446035_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[10]="./data/SRR446036_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[11]="./data/SRR446037_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[12]="./data/SRR446038_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[13]="./data/SRR446039_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[14]="./data/SRR446040_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[15]="./data/SRR446041_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[16]="./data/SRR446042_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[17]="./data/SRR446043_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[18]="./data/SRR446044_1.fastq.gz": No such file or directory</span>
<span class="r-in"><span class="va">bfl</span> <span class="op">&lt;-</span> <span class="fu">BamFileList</span><span class="op">(</span><span class="fu"><a href="sysargs.html">outpaths</a></span><span class="op">(</span><span class="va">args_bam</span><span class="op">)</span>, yieldSize<span class="op">=</span><span class="fl">50000</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">##########################################</span></span>
<span class="r-in"><span class="co">## Examples with \code{SYSargs2} object ##</span></span>
<span class="r-in"><span class="co">##########################################</span></span>
<span class="r-in"><span class="co">## Construct SYSargs2 object </span></span>
<span class="r-in"><span class="co">## SYSargs2 with paths to range data and count files</span></span>
<span class="r-in"><span class="va">dir_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cwl/count_rangesets"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">loadWF</a></span><span class="op">(</span>targets <span class="op">=</span> <span class="st">"targets_macs.txt"</span>, wf_file <span class="op">=</span> <span class="st">"count_rangesets.cwl"</span>, </span>
<span class="r-in">    input_file <span class="op">=</span> <span class="st">"count_rangesets.yml"</span>, dir_path <span class="op">=</span> <span class="va">dir_path</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkflow.html">renderWF</a></span><span class="op">(</span><span class="va">args</span>, inputvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>FileName <span class="op">=</span> <span class="st">"_FASTQ_PATH1_"</span>, SampleName <span class="op">=</span> <span class="st">"_SampleName_"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Iterative read counting</span></span>
<span class="r-in"><span class="va">countDFnames</span> <span class="op">&lt;-</span> <span class="fu">countRangeset</span><span class="op">(</span><span class="va">bfl</span>, <span class="va">args</span>, mode<span class="op">=</span><span class="st">"Union"</span>, ignore.strand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##########################################</span></span>
<span class="r-in"><span class="co">## Examples with \code{SYSargs} object ##</span></span>
<span class="r-in"><span class="co">##########################################</span></span>
<span class="r-in"><span class="co">## Construct SYSargs object </span></span>
<span class="r-in"><span class="co">## SYSargs with paths to range data and count files</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="systemArgs.html">systemArgs</a></span><span class="op">(</span>sysma<span class="op">=</span><span class="st">"param/count_rangesets.param"</span>, mytargets<span class="op">=</span><span class="st">"targets_macs.txt"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Iterative read counting</span></span>
<span class="r-in"><span class="va">countDFnames</span> <span class="op">&lt;-</span> <span class="fu">countRangeset</span><span class="op">(</span><span class="va">bfl</span>, <span class="va">args</span>, mode<span class="op">=</span><span class="st">"Union"</span>, ignore.strand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="writeTargetsout.html">writeTargetsout</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">args</span>, file<span class="op">=</span><span class="st">"targets_countDF.txt"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://girke.bioinformatics.ucr.edu/" class="external-link">Thomas Girke</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

