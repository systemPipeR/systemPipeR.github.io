<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Differential abundance analysis for many range sets — runDiff • systemPipeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Differential abundance analysis for many range sets — runDiff"><meta property="og:description" content="Convenience wrapper function for run_edgeR and run_DESeq2 to
perform differential expression or abundance analysis iteratively for several
count tables. The latter can be peak calling results for several samples or
counts generated for different genomic feature types. The function also returns 
the filtering results and plots from filterDEGs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-CCMXLYXWYV"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CCMXLYXWYV');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">systemPipeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential abundance analysis for many range sets</h1>
    
    <div class="hidden name"><code>runDiff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convenience wrapper function for <code>run_edgeR</code> and <code>run_DESeq2</code> to
perform differential expression or abundance analysis iteratively for several
count tables. The latter can be peak calling results for several samples or
counts generated for different genomic feature types. The function also returns 
the filtering results and plots from <code>filterDEGs</code>.</p>
    </div>

    <div id="ref-usage">Usage,<div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">runDiff</span><span class="op">(</span><span class="va">args</span>, <span class="va">diffFct</span>, <span class="va">targets</span>, <span class="va">cmp</span>, <span class="va">dbrfilter</span>, <span class="va">...</span><span class="op">)</span></code></pre></div></div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>args</dt>
<dd><p>Object of class <code>SYSargs</code> or <code>SYSargs2</code> where <code>infile1(args)</code> specifies the
paths to the tabular read count data files and <code>outputs</code> files to
the result files.</p></dd>
<dt>diffFct</dt>
<dd><p>Defines which function should be used for the differential abundance analysis.
Can be <code>diffFct=run_edgeR</code> or <code>diffFct=run_DESeq2</code>.</p></dd>
<dt>targets</dt>
<dd><p>targets <code>data.frame</code></p></dd>
<dt>cmp</dt>
<dd><p><code>character matrix</code> where comparisons are defined in two columns. This matrix should be generated with <code><a href="readComp.html">readComp()</a></code> from the targets file. Values used for comparisons need to match those in the <code>Factor</code> column of the targets file.</p></dd>
<dt>dbrfilter</dt>
<dd><p>Named vector with filter cutoffs of format <code>c(Fold=2, FDR=1)</code> where <code>Fold</code> refers to the fold change cutoff (unlogged) and <code>FDR</code> to the p-value cutoff. Those values are passed on to the <code>filterDEGs</code> function.</p></dd>
<dt>...</dt>
<dd><p>Arguments to be passed on to the internally used <code>run_edgeR</code> or <code>run_DESeq2</code> function.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns <code>list</code> containing the <code>filterDEGs</code> results for each
count table. Each result set is a <code>list</code> with four components 
which are described under <code><a href="filterDEGs.html">?filterDEGs</a></code>. The result files
contain the <code>edgeR</code> or <code>DESeq2</code> results from the comparisons
specified under <code>cmp</code>. The base names of the result files are the 
same as the corresponding input files specified under <code>countfiles</code>and the value of <code>extension</code> appended.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Girke</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>run_edgeR</code>, <code>run_DESeq2</code>, <code>filterDEGs</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Paths to BAM files</span></span>
<span class="r-in"><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"bowtieSE.param"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"targets.txt"</span>, package<span class="op">=</span><span class="st">"systemPipeR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args_bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="systemArgs.html">systemArgs</a></span><span class="op">(</span>sysma<span class="op">=</span><span class="va">param</span>, mytargets<span class="op">=</span><span class="va">targets</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[1]="./data/SRR446027_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[2]="./data/SRR446028_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[3]="./data/SRR446029_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[4]="./data/SRR446030_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[5]="./data/SRR446031_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[6]="./data/SRR446032_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[7]="./data/SRR446033_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[8]="./data/SRR446034_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[9]="./data/SRR446035_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[10]="./data/SRR446036_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[11]="./data/SRR446037_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[12]="./data/SRR446038_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[13]="./data/SRR446039_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[14]="./data/SRR446040_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[15]="./data/SRR446041_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[16]="./data/SRR446042_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[17]="./data/SRR446043_1.fastq.gz": No such file or directory</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>path[18]="./data/SRR446044_1.fastq.gz": No such file or directory</span>
<span class="r-in"><span class="va">bfl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rsamtools/man/BamFile-class.html" class="external-link">BamFileList</a></span><span class="op">(</span><span class="fu"><a href="sysargs.html">outpaths</a></span><span class="op">(</span><span class="va">args_bam</span><span class="op">)</span>, yieldSize<span class="op">=</span><span class="fl">50000</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## SYSargs with paths to range data and count files</span></span>
<span class="r-in"><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="systemArgs.html">systemArgs</a></span><span class="op">(</span>sysma<span class="op">=</span><span class="st">"param/count_rangesets.param"</span>, mytargets<span class="op">=</span><span class="st">"targets_macs.txt"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Iterative read counting</span></span>
<span class="r-in"><span class="va">countDFnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="countRangeset.html">countRangeset</a></span><span class="op">(</span><span class="va">bfl</span>, <span class="va">args</span>, mode<span class="op">=</span><span class="st">"Union"</span>, ignore.strand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="writeTargetsout.html">writeTargetsout</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">args</span>, file<span class="op">=</span><span class="st">"targets_countDF.txt"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Run differential abundance analysis</span></span>
<span class="r-in"><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="readComp.html">readComp</a></span><span class="op">(</span>file<span class="op">=</span><span class="va">args_bam</span>, format<span class="op">=</span><span class="st">"matrix"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">args_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="systemArgs.html">systemArgs</a></span><span class="op">(</span>sysma<span class="op">=</span><span class="st">"param/rundiff.param"</span>, mytargets<span class="op">=</span><span class="st">"targets_countDF.txt"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dbrlist</span> <span class="op">&lt;-</span> <span class="fu">runDiff</span><span class="op">(</span><span class="va">args</span>, diffFct<span class="op">=</span><span class="va">run_edgeR</span>, targets<span class="op">=</span><span class="fu"><a href="sysargs.html">targetsin</a></span><span class="op">(</span><span class="va">args_bam</span><span class="op">)</span>, cmp<span class="op">=</span><span class="va">cmp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, independent<span class="op">=</span><span class="cn">TRUE</span>, dbrfilter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span>Fold<span class="op">=</span><span class="fl">2</span>, FDR<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="writeTargetsout.html">writeTargetsout</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">args_diff</span>, file<span class="op">=</span><span class="st">"targets_rundiff.txt"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://girke.bioinformatics.ucr.edu/" class="external-link">Thomas Girke</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.</p>
</div>

      </footer></div>

  


  

  </body></html>

